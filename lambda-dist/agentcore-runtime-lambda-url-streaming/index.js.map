{
  "version": 3,
  "sources": ["../../lambda/agentcore-runtime-lambda-url-streaming/index.ts"],
  "sourcesContent": ["import { BedrockAgentCoreClient, InvokeAgentRuntimeCommand } from '@aws-sdk/client-bedrock-agentcore';\nimport { randomUUID } from 'crypto';\nimport { pipeline } from 'node:stream/promises';\nimport { Readable } from 'node:stream';\n\nconst client = new BedrockAgentCoreClient();\n\n// ref : https://docs.aws.amazon.com/lambda/latest/dg/response-streaming-tutorial.html\nexport const handler = awslambda.streamifyResponse(async (event, responseStream) => {\n  try {\n    // Parse request\n    const body = JSON.parse(event.body || '{}');\n    const prompt = body.prompt || 'Hello';\n    const sessionId = body.session_id || randomUUID();\n\n    // Invoke agent\n    const command = new InvokeAgentRuntimeCommand({\n      agentRuntimeArn: process.env.ACORE_RUNTIME_ARN,\n      runtimeSessionId: sessionId,\n      payload: Buffer.from(JSON.stringify({ prompt }))\n    });\n\n    const response = await client.send(command);\n    \n    // Stream response\n    await pipeline(Readable.from(response.response), responseStream);\n    \n  } catch (error: any) {\n    responseStream.write(JSON.stringify({ \n      error: error.message || 'Unknown error',\n      type: error.name || 'Error'\n    }));\n  } finally {\n    responseStream.end();\n  }\n});"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,aAAAE,IAAA,eAAAC,EAAAH,GAAA,IAAAI,EAAkE,6CAClEC,EAA2B,kBAC3BC,EAAyB,gCACzBC,EAAyB,uBAEnBC,EAAS,IAAI,yBAGNN,EAAU,UAAU,kBAAkB,MAAOO,EAAOC,IAAmB,CAClF,GAAI,CAEF,IAAMC,EAAO,KAAK,MAAMF,EAAM,MAAQ,IAAI,EACpCG,EAASD,EAAK,QAAU,QACxBE,EAAYF,EAAK,eAAc,cAAW,EAG1CG,EAAU,IAAI,4BAA0B,CAC5C,gBAAiB,QAAQ,IAAI,kBAC7B,iBAAkBD,EAClB,QAAS,OAAO,KAAK,KAAK,UAAU,CAAE,OAAAD,CAAO,CAAC,CAAC,CACjD,CAAC,EAEKG,EAAW,MAAMP,EAAO,KAAKM,CAAO,EAG1C,QAAM,YAAS,WAAS,KAAKC,EAAS,QAAQ,EAAGL,CAAc,CAEjE,OAASM,EAAY,CACnBN,EAAe,MAAM,KAAK,UAAU,CAClC,MAAOM,EAAM,SAAW,gBACxB,KAAMA,EAAM,MAAQ,OACtB,CAAC,CAAC,CACJ,QAAE,CACAN,EAAe,IAAI,CACrB,CACF,CAAC",
  "names": ["index_exports", "__export", "handler", "__toCommonJS", "import_client_bedrock_agentcore", "import_crypto", "import_promises", "import_node_stream", "client", "event", "responseStream", "body", "prompt", "sessionId", "command", "response", "error"]
}
